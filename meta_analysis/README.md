# Meta-analysis of PhysiBoSS Output Building Block

This package provides the Meta-analysis of PhysiBoSS Output **Building Block (BB)**.

## Table of Contents

- [Meta-analysis of PhysiBoSS Output Building Block](#meta-analysis-of-pysiboss-output-building-block)
  - [Table of Contents](#table-of-contents)
  - [Description](#description)
  - [User instructions](#user-instructions)
    - [Requirements](#requirements)
    - [Installation](#installation)
    - [Usage](#usage)
    - [Uninstall](#uninstall)
  - [License](#license)
  - [Contact](#contact)

## Description

This building block is designed to analyse the set of simulations generated for each individual in order to assess whether any of the parameters of interest show a differential distribution between the phenotypic subgroups included in a sample. To do so, the building block processes the output generated by the patient-personalized PhysiBoSS runs, including for each individual a given number of replicates of both wild-type and mutant experiments.

In our approach, we initially employed hierarchical clustering and PCA to assess the grouping of replicates for each individual and the clustering of patients with similar subtypes. Additionally, through the application of statistical tests comparing means, we identified parameters derived from simulations that exhibited differential behaviour between patient groups. This, in turn, could suggest potential cellular changes warranting further investigation in future research.

## User instructions

### Requirements

- Python >= 3.6
- [Singularity](https://singularity.lbl.gov/docs-installation)
- `permedcoe` base package: `python3 -m pip install permedcoe`

In addition to the dependencies, it is necessary to generate the associated
singularity image ([`meta_analysis.singularity`](../Resources/images/meta_analysis.singularity)),
located in the **Resources** folder of this repository.

They **MUST be available and exported in the following environment variable**
before its usage:

```bash
export PERMEDCOE_IMAGES="/path/to/images/"
```

### Installation

This package provides an automatic installation script:

```bash
./install.sh
```

### Usage

The `meta_analysis` package provides a clear interface that allows
it to be used with multiple workflow managers (e.g. PyCOMPSs, NextFlow and
Snakemake).

It can be imported from python and invoked directly from a **PyCOMPSs**
application, or through the command line for other workflow managers
(e.g. Snakemake and NextFlow).

The command line is:

```bash
meta_analysis_BB -d \
    --tmpdir <working_directory> \
    --meta_file <meta_file> \
    --out_dir <out_dir> \
    --model_prefix <model_prefix> \
    --ko_file <ko_file> \
    --reps <reps> \
    --verbose <verbose> \
    --result_folder <result_folder>
```

Where the parameters are:

|        | Flag                | Parameter            | Type   | Description                                         |
|--------|---------------------|----------------------|--------|-----------------------------------------------------|
|        | --tmpdir            | \<working_directory> | Folder | Working directory (temporary files)                 |
| Input  | --meta_file         | \<meta_file>         | File   | Sample information                                  |
| Input  | --out_dir           | \<out_dir>           | Folder | Simulations output folder                           |
| Input  | --model_prefix      | \<model_prefix>      | String | Prefix of the boolean model used in the simulations |
| Input  | --ko_file           | \<ko_file>           | File   | Evaluated gene KOs                                  |
| Input  | --reps              | \<reps>              | Int    | Number of replicas                                  |
| Input  | --verbose           | \<verbose>           | String | Verbose level                                       |
| Output | --result_folder     | \<result_folder>     | Folder | Output folder                                       |

### Uninstall

Uninstall can be achieved by executing the following scripts:

```bash
./uninstall.sh
./clean.sh
```

## License

[Apache 2.0](https://www.apache.org/licenses/LICENSE-2.0)

## Contact

<https://permedcoe.eu/contact/>

This software has been developed for the [PerMedCoE project](https://permedcoe.eu/), funded by the European Commission (EU H2020 [951773](https://cordis.europa.eu/project/id/951773)).

![](https://permedcoe.eu/wp-content/uploads/2020/11/logo_1.png "PerMedCoE")
